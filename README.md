# ML ДЗ 1 ч.2 

Выполнила: Гусманова Э.Э

## Постановка задачи

Необходимо создать интерактивное приложение на Streamlit, которое будет:
- [x] показывать основные информативные графики/гистограммы в рамках EDA (1 балл)
- [x] на вход запрашивать csv-файл с признаками объектов и применять на поступивших объектах модель (1 балл)
- [x] визуализировать веса обученной модели (1 балл)

## Структура проекта

- ./data/ - папка с наборами данных + сохранёнными с трейна медианами для заполнения пропусков
- ./models/ - папка с сохранёнными весами моделей, в т.ч. и трансформеров (нормализация + OHE кодирование)
- ./pages/ - папка со страницами приложения, чтобы вынести EDA часть на отдельную страницу
- ./app.py - основной файл с загрузкой csv и предсказанием цены
- ./edaUtils.py - вспомогательные функции по очистке и визуализации данных
- ./requirements.txt - файл с зависимостями проекта
- ./AI_HW1_Inference_GusmanovaEE.ipynb - блокнот, где были обучены и экспортированы модели, в т.ч. трансформер (нормализация + OHE кодирование)
- ./pages/eda.py - страница с разведочным анализом тренировочного набора

Все функции предобработки и графики брались из первой части ДЗ 1. Трансформер используется со следующей конфигурацией:

```python
ohe_std_transformer = ColumnTransformer(transformers=[('ohe', OneHotEncoder(drop='first', handle_unknown='ignore', sparse_output=False), ['name', 'fuel', 'seller_type', 'transmission', 'owner', 'seats']),
                                                  ('standard', StandardScaler(), ['year','km_driven','mileage','engine','max_power','torque','max_torque_rpm'] )], remainder='passthrough', verbose_feature_names_out=False)
ohe_std_transformer.set_output(transform='pandas')
```

От целевой переменной дополнительно берётся натуральный логарифм для решкалирования.

## Установка и запуск проекта локально

1. Активировать виртуальное окружение
2. Установить зависимости

```console
pip install -r requirements.txt
```

3. Запустить streamlit

```console
streamlit run app.py
```

## Деплой приложения


## Выводы (копия выводов из части 6 ДЗ 1)


Сделано: EDA, попробованы разные обработки признаков, обучено несколько разных моделей, в т.ч. и с применением подбора параметров по сетке, для обучения использовались различные конфигурации датасета

Результаты: довольно средние, в большинстве случаев r2 метрика составляла в районе 0.5-0.6, но после добавления категориальных признаков и решкалирования таргета удалось поднять её до 0.7-0.9

Наибольший буст в качестве дало решкалирование таргета (взятие натурального логарифма)

Не вышло: сделать L0 регуляризацию, так как меня ставит в тупик то, что она не дифференцируема

